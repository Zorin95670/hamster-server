import{_ as h,b,c as B,Q as E}from"./TagChip.471f05d9.js";import{Q as d,a as P,b as q}from"./QTable.23a2a766.js";import{Q as S}from"./QPage.3c61cbd4.js";import{f as N,u as A}from"./TagService.bb90c41a.js";import{r as i,l as Q,m as w,n as l,j as t,Z as c,am as $,Q as D,i as I,aQ as j,o as z,a as F,_ as x}from"./index.187af2f5.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";import{E as v}from"./QList.158cf0bc.js";import{u as L}from"./vue-i18n.runtime.ea79e2d8.js";import"./scroll.74f98dda.js";import"./format.865294d5.js";const M=["onClick"],R=["onClick"],Z={__name:"TagTable",props:{tags:{type:Array,required:!0}},emits:["save","update:backgroundColor","update:textColor"],setup(_){const m=i([{name:"name",field:"name",label:"Tag name",align:"left"},{name:"backgroundColor",field:"backgroundColor",label:"Background color",align:"left"},{name:"textColor",field:"textColor",label:"Text color",align:"left"},{name:"count",field:"count",label:"Linked activity",align:"left"},{name:"actions",field:"id",label:"Actions",align:"left"}]);return(r,u)=>(Q(),w(P,{columns:m.value,rows:_.tags},{"body-cell-name":l(a=>[t(d,{key:"name",props:a},{default:l(()=>[t(h,{tag:a.row},null,8,["tag"])]),_:2},1032,["props"])]),"body-cell-backgroundColor":l(a=>[t(d,{key:"backgroundColor",props:a},{default:l(()=>[c("div",{class:$(["cube",`bg-${a.row.backgroundColor}`]),onClick:n=>r.$emit("update:backgroundColor",a.row)},null,10,M)]),_:2},1032,["props"])]),"body-cell-textColor":l(a=>[t(d,{key:"textColor",props:a},{default:l(()=>[c("div",{class:$(["cube",`bg-${a.row.textColor}`]),onClick:n=>r.$emit("update:textColor",a.row)},null,10,R)]),_:2},1032,["props"])]),"body-cell-actions":l(a=>[t(d,{key:"actions",props:a},{default:l(()=>[t(D,{dense:"",flat:"",rounded:"",color:"positive",icon:"save",class:"q-mr-sm",onClick:n=>r.$emit("save",a.row.id)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["columns","rows"]))}};var G=K(Z,[["__scopeId","data-v-010942b4"]]);function H(){return I(j)}const J={class:"text-h6"},se={__name:"TagsPage",setup(_){const m=H(),{t:r}=L(),u=i([]),a=i(!0),n=i(""),f=i(!1),g={withCount:"true"};let C,k;function p(){a.value=!0,N(g).then(e=>{u.value=e.data.content}).catch(e=>console.log("error",e)).finally(()=>{a.value=!1})}function y(){g.name=n.value.length>0?`lk_*${n.value}*`:null,g.linkedActivity=f.value?"gt_0":null,p()}function T(e,o){v.DialogEvent.next({key:"update-color",type:"open",id:o.id,field:e,color:o[e]})}function U(e){u.value.find(({id:o})=>o===e.id)[e.field]=e.color}function V(e){A(u.value.find(({id:o})=>o===e)).then(()=>{m.notify({message:r("TagsPage.tagUpdated"),color:"positive"})})}return z(()=>{C=v.UpdateColorEvent.subscribe(U),k=v.ReloadTagsEvent.subscribe(p),p()}),F(()=>{C.unsubscribe(),k.unsubscribe()}),(e,o)=>(Q(),w(S,{class:"flex column items-start"},{default:l(()=>[c("h3",null,x(e.$t("TagsPage.title")),1),t(E,{class:"flex row items-center"},{default:l(()=>[t(b,null,{default:l(()=>[c("div",J,x(e.$t("TagsPage.filters")),1)]),_:1}),t(b,null,{default:l(()=>[t(B,{outlined:"",label:e.$t("TagsPage.filterByName"),modelValue:n.value,"onUpdate:modelValue":[o[0]||(o[0]=s=>n.value=s),y]},null,8,["label","modelValue"])]),_:1}),t(b,null,{default:l(()=>[t(q,{label:e.$t("TagsPage.filterByUnused"),modelValue:f.value,"onUpdate:modelValue":[o[1]||(o[1]=s=>f.value=s),y]},null,8,["label","modelValue"])]),_:1})]),_:1}),t(G,{class:"q-mt-md",tags:u.value,onSave:V,"onUpdate:backgroundColor":o[2]||(o[2]=s=>T("backgroundColor",s)),"onUpdate:textColor":o[3]||(o[3]=s=>T("textColor",s))},null,8,["tags"])]),_:1}))}};export{se as default};
